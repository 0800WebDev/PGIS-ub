<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PGIS-UB åå</title>
<style>
  body { font-family: sans-serif; background: #111; color: #eee; padding: 10px; }
  a { color: #4ea1ff; text-decoration: none; }
  a:hover { text-decoration: underline; }
  img { max-width: 200px; margin: 5px; border: 1px solid #444; }
  iframe { border: 1px solid #444; width: 100%; height: 400px; margin: 10px 0; }
  pre { background: #222; padding: 10px; overflow-x: auto; }






  /* === error NOTICE POPUP === */
#ub-popup-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.75);
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
}

#ub-popup {
    background: #111;
    color: whitesmoke;
    border: 1px solid #444;
    border-radius: 8px;
    width: 90%;
    max-width: 420px;
    padding: 20px;
    text-align: center;
    animation: fadeIn 0.6s ease;
}

#ub-popup h2 {
    margin-top: 0;
}

#ub-popup a {
    color: #4da6ff;
}

#ub-popup button {
    margin-top: 15px;
    padding: 8px 14px;
    background: #444;
    color: whitesmoke;
    border: none;
    border-radius: 4px;
}

#ub-popup button:hover {
    background: lightgray;
    color: black;
}
  a {
    color: white;
  }

</style>
</head>
<body>


<div id="ub-popup-overlay">
    <div id="ub-popup">
        <h2>Important:</h2>
        <p>
            <b>the site might have some glitches here and there</b>.<br><br>
            if you notice any<b> bugs, errors or glitches </b>please report them <b><a href="https://forms.gle/erkUk4RwsWbYbKLH8" target="_blank">here</a></b>
        </p>
        <button onclick="closeUbPopup()">Continue to this site</button>
    </div>
</div>



  
<h1> UB </h1>
<div id="content">Loading page...</div>

<script>
function closeUbPopup() {
    const popup = document.getElementById('ub-popup-overlay');
    if (popup) popup.remove();
}
</script>
  

<script>
/* ================= CONFIG ================= */
const USER = "0800WebDev";          // GitHub username
const REPO = "PGIS";               // Repo name
const BRANCH = "main";             // Branch
const HOSTED_IFRAME = "https://pgis.onrender.com";
/* ========================================== */

const baseRawURL = `https://raw.githubusercontent.com/${USER}/${REPO}/${BRANCH}/`;
const contentDiv = document.getElementById("content");
if (!contentDiv) throw new Error("#content div missing");

/* ---------- PATH RESOLVER ---------- */
function resolvePath(from, to) {
  if (!to) return null;
  if (to.includes("://")) return to;
  if (to.startsWith("/")) return to.slice(1);

  const base = from.split("/").slice(0, -1);
  for (const part of to.split("/")) {
    if (part === "." || part === "") continue;
    if (part === "..") base.pop();
    else base.push(part);
  }
  return base.join("/");
}

/* ---------- MAIN LOADER ---------- */
async function loadPage(pagePath) {
  try {
    pagePath = pagePath.replace(/^\/+/, "");

    // ✅ Add this: if path ends with / or has no .html, append index.html
    if (pagePath.endsWith("/")) pagePath += "index.html";
    else if (!pagePath.includes(".")) pagePath += "/index.html";

    currentPagePath = pagePath;

    const res = await fetch(baseRawURL + pagePath);
    if (!res.ok) throw new Error(`HTML ${res.status}: ${pagePath}`);
    const html = await res.text();
    const doc = new DOMParser().parseFromString(html, "text/html");

    contentDiv.innerHTML = "";

    // …rest of your loader code stays the same…

    // Body content (skip scripts)
    [...doc.body.children].forEach(el => {
      if (el.tagName !== "SCRIPT") contentDiv.appendChild(document.importNode(el, true));
    });

    // Inject <style>
    doc.querySelectorAll("style").forEach(s => {
      const ns = document.createElement("style");
      ns.textContent = s.textContent;
      document.head.appendChild(ns);
    });

    // Inject <link rel="stylesheet">
    doc.querySelectorAll('link[rel="stylesheet"]').forEach(l => {
      const nl = document.createElement("link");
      nl.rel = "stylesheet";
      nl.href = baseRawURL + resolvePath(pagePath, l.getAttribute("href"));
      document.head.appendChild(nl);
    });

    // Inject scripts (ignore errors)
    doc.querySelectorAll("script").forEach(s => {
      try {
        const ns = document.createElement("script");
        if (s.src && !s.src.includes("://")) {
          ns.src = baseRawURL + resolvePath(pagePath, s.getAttribute("src"));
        } else {
          ns.textContent = s.textContent;
        }
        document.body.appendChild(ns);
      } catch(e) {
        console.warn("Skipped script error:", e);
      }
    });

    // Images
    contentDiv.querySelectorAll("img").forEach(img => {
      const src = img.getAttribute("src");
      if (src && !src.includes("://")) img.src = baseRawURL + resolvePath(pagePath, src);
    });

    // Links — GitHub repo for paths starting with /
    contentDiv.querySelectorAll("a").forEach(a => {
      const href = a.getAttribute("href");
      if (!href) return;

      a.onclick = e => {
        e.preventDefault();
        if (href.startsWith("/")) {
          loadPage(href.slice(1));
        } else if (!href.includes("://")) {
          loadPage(resolvePath(currentPagePath, href));
        } else {
          window.location.href = href;
        }
      };
    });

    // Iframes → hosted server
    contentDiv.querySelectorAll("iframe").forEach(f => {
      const src = f.getAttribute("src");
      if (src && !src.includes("://")) f.src = HOSTED_IFRAME + "/" + resolvePath(currentPagePath, src);
    });

  } catch(err) {
    contentDiv.innerHTML = `<pre>LOAD ERROR:\n${err.message}</pre>`;
    console.warn(err);
  }
}

/* ---------- DYNAMIC STARTER PAGE ---------- */
const urlPath = window.location.pathname.slice(1);
const starterPage = urlPath ? urlPath : "ub.html";
let currentPagePath = starterPage;
loadPage(starterPage);
</script>



</body>
</html>
























<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PGIS-UB</title>
<style>
  body { font-family: sans-serif; background: #111; color: #eee; padding: 10px; }
  a { color: #4ea1ff; text-decoration: none; }
  a:hover { text-decoration: underline; }
  img { max-width: 200px; margin: 5px; border: 1px solid #444; }
  iframe { border: 1px solid #444; width: 100%; height: 400px; margin: 10px 0; }
  pre { background: #222; padding: 10px; overflow-x: auto; }
</style>
</head>
<body>

<h1>PGIS UB </h1>
    <strong>note: the site miht have some glitches here and there and also just ignore the switch to ub version message</strong>
<div id="content">Loading index.html...</div>

<script>
const USER = "0800WebDev";        // GitHub username
const REPO = "PGIS";       // Repo name
const BRANCH = "main";          // Branch
const HOSTED_IFRAME = "https://pgis.onrender.com"; // Hosted server for iframe content
const baseRawURL = `https://raw.githubusercontent.com/${USER}/${REPO}/${BRANCH}/`;
const contentDiv = document.getElementById("content");

// ===== Load any page from GitHub dynamically =====
async function loadPage(pagePath) {
  try {
    if (pagePath.startsWith("/")) pagePath = pagePath.slice(1);
    const fileURL = baseRawURL + pagePath;
    const htmlText = await (await fetch(fileURL)).text();
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlText, "text/html");

    // Clear old content
    contentDiv.innerHTML = "";

    // Inject body content (excluding scripts)
    doc.body.childNodes.forEach(node => {
      if (node.tagName === "SCRIPT") return;
      contentDiv.appendChild(document.importNode(node, true));
    });

    // Inject <style> tags
    doc.querySelectorAll("style").forEach(styleTag => {
      const newStyle = document.createElement("style");
      newStyle.textContent = styleTag.textContent;
      document.head.appendChild(newStyle);
    });

    // Inject <link rel="stylesheet">
    doc.querySelectorAll('link[rel="stylesheet"]').forEach(link => {
      const newLink = document.createElement("link");
      newLink.rel = "stylesheet";
      newLink.href = baseRawURL + link.getAttribute("href");
      document.head.appendChild(newLink);
    });

    // Inject <script> tags
    doc.querySelectorAll("script").forEach(script => {
      const newScript = document.createElement("script");
      if (script.src) newScript.src = baseRawURL + script.getAttribute("src");
      else newScript.textContent = script.textContent;
      document.body.appendChild(newScript);
    });

    // Fix relative images
    contentDiv.querySelectorAll("img").forEach(img => {
      if (!img.src.includes("://")) img.src = baseRawURL + img.getAttribute("src");
    });

    // ===== Intercept internal links for SPA navigation =====
    contentDiv.querySelectorAll("a").forEach(a => {
      const href = a.getAttribute("href");
      if (!href) return;
      if (href.startsWith("/") || !href.includes("://")) {
        a.addEventListener("click", e => {
          e.preventDefault();
          loadPage(href);
        });
      }
    });

    // ===== Rewrite iframes to hosted server =====
    contentDiv.querySelectorAll("iframe").forEach(iframe => {
      const src = iframe.getAttribute("src");
      if (!src) return;
      if (src.startsWith("/")) {
        iframe.src = HOSTED_IFRAME + src;
      }
    });

  } catch (err) {
    contentDiv.innerHTML = `Failed to load ${pagePath}: ${err}`;
    console.error(err);
  }
}

// ===== Load index.html by default =====
loadPage("ub.html");
</script>


</body>
</html>























